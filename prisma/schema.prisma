generator client {
  provider   = "prisma-client-js"
  engineType = "node-api"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String     @id @default(cuid())
  email     String     @unique
  resumes   Resume[]
  analyses  Analysis[]
  createdAt DateTime   @default(now())
}

model Resume {
  id       String     @id @default(cuid())
  userId   String
  url      String
  fileKey  String?
  fileName String?
  analyses Analysis[]

  user User @relation(fields: [userId], references: [id])
}

model Analysis {
  id        String   @id @default(cuid())
  userId    String
  resumeId  String
  createdAt DateTime @default(now())
  result    Json

  user   User   @relation(fields: [userId], references: [id])
  resume Resume @relation(fields: [resumeId], references: [id])
}

model UserResume {
  id          String   @id @default(cuid())
  userId      String
  fileName    String
  fileUrl     String
  uploadedAt  DateTime @default(now())
  atsScore    Int?
  status      String   @default("Processing")

  @@index([userId])
}
